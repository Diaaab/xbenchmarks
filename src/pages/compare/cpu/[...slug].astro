---
import ComparisonLayout from "../../../layouts/ComparisonLayout.astro";
import cpus from "../../../data/cpus.json";
import { getComparisons } from "../../../utils/getComparisons.js";

export async function getStaticPaths() {
	const comparisons = getComparisons(cpus, 500);
	const paths = comparisons.map((comparison) => ({
		params: { slug: `${comparison[0].slug}-vs-${comparison[1].slug}` },
		props: { item1: comparison[0], item2: comparison[1] },
	}));
	return paths;
}

const { item1, item2 } = Astro.props;

function calculateAdvantages(item1, item2) {
  const advantages1 = [];
  const advantages2 = [];

  if (item1.cores > item2.cores) {
    advantages1.push({ type: 'positive', text: 'More cores' });
  } else if (item2.cores > item1.cores) {
    advantages2.push({ type: 'positive', text: 'More cores' });
  }

  if (item1.threads > item2.threads) {
    advantages1.push({ type: 'positive', text: 'More threads' });
  } else if (item2.threads > item1.threads) {
    advantages2.push({ type: 'positive', text: 'More threads' });
  }

  return { advantages1, advantages2 };
}

const { advantages1, advantages2 } = calculateAdvantages(item1, item2);

const item1WithAdvantages = { ...item1, advantages: advantages1 };
const item2WithAdvantages = { ...item2, advantages: advantages2 };
---

<ComparisonLayout
  item1={item1WithAdvantages}
  item2={item2WithAdvantages}
  title=`${item1.name} vs ${item2.name} - CPU Comparison`
/>
